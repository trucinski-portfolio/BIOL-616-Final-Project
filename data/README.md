# Data Directory README

This directory contains all data inputs and intermediate artifacts required for the **TCGA-BRCA Luminal A Invasive Ductal Carcinoma (IDC)** differential expression and pathway enrichment pipeline.

Due to file size and licensing constraints, **raw TCGA data and GSEA outputs are not tracked in Git** and must be provided locally.

---

## Directory Structure Overview

Raw Data (data/raw/)

Contains unmodified TCGA inputs downloaded from the UCSC Xena Browser.
	•	preprocessing_inputs/
Raw TCGA BRCA RNA-seq expression matrix and clinical phenotype data.
These files are required locally but excluded from version control.

⸻

Processed Data (data/processed/)

Contains intermediate artifacts generated by the pipeline.
	•	preprocessing_outputs/
Harmonized metadata table and matched expression matrix generated during preprocessing.
	•	GSEA_input/
Ranked gene list (.rnk) generated from limma t-statistics and used as input for GSEA Preranked.

⸻

GSEA Output (data/GSEA_output/)

Contains results generated externally using the UCSD/Broad Institute GSEA software.

Subdirectories are organized by gene set library:
	•	Hallmark-All/
GSEA Preranked results for Hallmark gene sets.
	•	KEGG-Legacy/
GSEA Preranked results for KEGG Legacy pathways.
	•	KEGG-Medicus/
GSEA Preranked results for KEGG Medicus pathways.

These directories must contain the gsea_report_for_na_pos_*.tsv and gsea_report_for_na_neg_*.tsv files produced by GSEA.

⸻

README
	•	data/README.md
Documents expected inputs, directory structure, and reproducibility assumptions for all data used in the pipeline.

---

## 1. Raw TCGA Data (NOT tracked in Git)

Raw expression and clinical phenotype data were obtained from the **UCSC Xena Browser** (TCGA-BRCA cohort).

These files **must exist locally** but are excluded from version control.

### Required files

- HiSeqV2_PANCAN.gz  
  TCGA BRCA RNA-seq expression matrix (Illumina HiSeq, pancan normalized)

- BRCA_clinicalMatrix.tsv  
  TCGA BRCA clinical and phenotype metadata

### Expected local path

data/raw/preprocessing_inputs/
• HiSeqV2_PANCAN.gz
• BRCA_clinicalMatrix.tsv

### Download sources

Expression matrix:  
https://tcga-xena-hub.s3.us-east-1.amazonaws.com/download/TCGA.BRCA.sampleMap%2FHiSeqV2_PANCAN.gz

Clinical metadata:  
https://tcga-xena-hub.s3.us-east-1.amazonaws.com/download/TCGA.BRCA.sampleMap%2FBRCA_clinicalMatrix

These files are consumed by:
- scripts/01_preprocessing.ipynb

---

## 2. Processed Intermediate Data (Generated by pipeline)

Intermediate outputs generated by the preprocessing and differential expression steps are written to:

data/processed/

### 2.1 Preprocessing outputs

Generated by scripts/01_preprocessing.ipynb.

data/processed/preprocessing_outputs/
• metadata_LumA_IDC_Tumor_vs_AllNormals.tsv
• expr_LumA_IDC_Tumor_vs_AllNormals.tsv

- Metadata contains sample IDs, group labels (Tumor vs Normal), molecular subtype, and histology.
- Expression matrix is restricted to the samples used in the final contrast.

### 2.2 GSEA input (ranked list)

Generated by scripts/02_differential_expression.ipynb.

data/processed/GSEA_input/
• LumA_IDC_Tumor_vs_AllNormals.rnk

- Ranked by **limma t-statistics**
- Directionality preserved
- Used as input for **GSEA Preranked**

These files can be regenerated at any time by rerunning the pipeline.

---

## 3. GSEA Output Data (External tool, NOT tracked in Git)

Gene Set Enrichment Analysis is performed **outside the pipeline** using the UCSD/Broad Institute **GSEA_4.4.0** software.

The pipeline does **not** run GSEA internally.

### Required outputs per gene set library

For each gene set library, the following files must be copied into the appropriate directory:

- gsea_report_for_na_pos_*.tsv
- gsea_report_for_na_neg_*.tsv

### Expected directory structure

Hallmark gene sets (data/GSEA_output/Hallmark-All/)
	•	gsea_report_for_na_pos_*.tsv
Positive enrichment results (pathways enriched in Tumor samples).
	•	gsea_report_for_na_neg_*.tsv
Negative enrichment results (pathways depleted in Tumor samples).

KEGG Legacy pathways (data/GSEA_output/KEGG-Legacy/)
	•	gsea_report_for_na_pos_*.tsv
Positive enrichment results.
	•	gsea_report_for_na_neg_*.tsv
Negative enrichment results.

KEGG Medicus pathways (data/GSEA_output/KEGG-Medicus/)
	•	gsea_report_for_na_pos_*.tsv
Positive enrichment results.
	•	gsea_report_for_na_neg_*.tsv
Negative enrichment results.

Notes:
- Timestamped filenames are expected and handled automatically.
- HTML reports generated by GSEA are not used by the pipeline.
- Results must correspond to the t-stat–based ranked list generated in Step 2.

These files are consumed by:
- scripts/03_visualization.ipynb

---

## 4. Final Outputs (Tracked in Git)

Final figures and summary tables generated by the pipeline are written to:

Figures

Differential Expression Figures (results/figures/deg/)
	•	Volcano_LumA_IDC_Tumor_vs_AllNormals.png
Volcano plot showing log2 fold change vs FDR for Luminal A IDC tumors compared to normal breast tissue.
	•	Top50_DEGs_Heatmap.png
Heatmap of the top differentially expressed genes (Up and Down regulated).
	•	Top50_DEGs_Heatmap.pdf
PDF version of the DEG heatmap for high-resolution viewing.

GSEA Figures (results/figures/gsea/)
	•	GSEA_Waterfall_Hallmark.png
Waterfall plot summarizing Hallmark gene set enrichment (GSEA Preranked).
	•	GSEA_Waterfall_KEGG_Legacy.png
Waterfall plot summarizing KEGG Legacy pathway enrichment.
	•	GSEA_Waterfall_KEGG_Medicus.png
Waterfall plot summarizing KEGG Medicus pathway enrichment.

⸻

Tables

Differential Expression Tables (results/tables/deg/)
	•	DEG_Results_LumA_IDC_Tumor_vs_AllNormals_limma.csv
Full differential expression results generated using limma-trend.
	•	DEG_Results_LumA_IDC_Tumor_vs_AllNormals_limma_annotated.csv
Annotated DEG table including regulation status (Up / Down / Not Significant).

GSEA Tables (results/tables/gsea/)
	•	GSEA_ALL_summary_LumA_IDC_Tumor_vs_AllNormals.csv
Combined GSEA summary across Hallmark, KEGG Legacy, and KEGG Medicus gene set libraries.
	•	LumA_IDC_Tumor_vs_AllNormals.rnk
Final t-statistic–based ranked gene list used for GSEA Preranked analysis.

⸻


---

## Reproducibility Notes

- The pipeline is deterministic up to the GSEA step.
- GSEA results depend on:
  - External software version
  - Gene set library versions
  - Ranking metric (t-statistics)
- All scripts assume execution from the repository root.

---

## Summary

- Raw TCGA data → manually downloaded  
- Preprocessing and differential expression → fully automated  
- GSEA → manual external step  
- Visualization and summaries → automated once GSEA outputs are placed correctly  

This separation is intentional and documented to ensure transparency and reproducibility.
