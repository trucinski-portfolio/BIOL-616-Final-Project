# Data Directory README

This directory contains all data inputs and intermediate artifacts required for the **TCGA-BRCA Luminal A Invasive Ductal Carcinoma (IDC)** differential expression and pathway enrichment pipeline.

Due to file size and licensing constraints, **raw TCGA data and GSEA outputs are not tracked in Git** and must be provided locally.

---

## Overview

The data used in this project fall into three categories:

1. Raw TCGA inputs (manually downloaded, not tracked)
2. Intermediate processed data (generated by the pipeline)
3. External GSEA outputs (generated outside the pipeline, not tracked)

Final figures and summary tables generated from these data are tracked in the `results/` directory.

---

## 1. Raw TCGA Data (NOT tracked in Git)

Raw expression and clinical phenotype data were obtained from the **UCSC Xena Browser** (TCGA-BRCA cohort).

These files **must exist locally** but are excluded from version control.

### Required files

- `HiSeqV2_PANCAN.gz`  
  TCGA BRCA RNA-seq expression matrix (Illumina HiSeq, pancancer normalized)

- `BRCA_clinicalMatrix.tsv`  
  TCGA BRCA clinical and phenotype metadata

### Expected local path

All raw inputs must be placed in:

`data/raw/preprocessing_inputs/`

The directory should contain:
- `HiSeqV2_PANCAN.gz`
- `BRCA_clinicalMatrix.tsv`

### Download sources

Expression matrix:  
https://tcga-xena-hub.s3.us-east-1.amazonaws.com/download/TCGA.BRCA.sampleMap%2FHiSeqV2_PANCAN.gz

Clinical metadata:  
https://tcga-xena-hub.s3.us-east-1.amazonaws.com/download/TCGA.BRCA.sampleMap%2FBRCA_clinicalMatrix

These files are consumed by:
- `scripts/01_preprocessing.ipynb`

---

## 2. Processed Intermediate Data (Generated by pipeline)

Intermediate artifacts generated by preprocessing and differential expression are written to:

`data/processed/`

These files are reproducible and can be regenerated at any time by rerunning the pipeline.

### 2.1 Preprocessing outputs

Generated by `scripts/01_preprocessing.ipynb`.

Location:
`data/processed/preprocessing_outputs/`

Files:
- `metadata_LumA_IDC_Tumor_vs_AllNormals.tsv`
- `expr_LumA_IDC_Tumor_vs_AllNormals.tsv`

Notes:
- Metadata includes sample IDs, tumor/normal group labels, molecular subtype, and histology.
- Expression matrix is restricted to the final analysis cohort.

### 2.2 GSEA input (ranked list)

Generated by `scripts/02_differential_expression.ipynb`.

Location:
`data/processed/GSEA_input/`

File:
- `LumA_IDC_Tumor_vs_AllNormals.rnk`

Notes:
- Ranked by **limma t-statistics**
- Directionality preserved
- Used as input for **GSEA Preranked**

---

## 3. GSEA Output Data (External tool, NOT tracked in Git)

Gene Set Enrichment Analysis is performed **outside the pipeline** using the UCSD/Broad Institute **GSEA_4.4.0** software.

The pipeline does **not** execute GSEA internally.

### Required outputs per gene set library

For each gene set library, the following files must be copied into the appropriate directory:

- `gsea_report_for_na_pos_*.tsv`
- `gsea_report_for_na_neg_*.tsv`

Timestamped filenames are expected and handled automatically.

### Expected locations

Hallmark gene sets:
- `data/GSEA_output/Hallmark-All/`

KEGG Legacy pathways:
- `data/GSEA_output/KEGG-Legacy/`

KEGG Medicus pathways:
- `data/GSEA_output/KEGG-Medicus/`

Notes:
- POS files correspond to pathways enriched in Tumor samples.
- NEG files correspond to pathways depleted in Tumor samples.
- HTML reports generated by GSEA are not used by the pipeline.
- Results must correspond to the **t-statisticâ€“based ranked list** generated in Step 2.

These files are consumed by:
- `scripts/03_visualization.ipynb`

---

## 4. Final Outputs (Tracked in Git)

Final figures and summary tables generated by the pipeline are written to the `results/` directory.

### Figures

Differential expression figures:
- `results/figures/deg/Volcano_LumA_IDC_Tumor_vs_AllNormals.png`
- `results/figures/deg/Top50_DEGs_Heatmap.png`
- `results/figures/deg/Top50_DEGs_Heatmap.pdf`

GSEA figures:
- `results/figures/gsea/GSEA_Waterfall_Hallmark.png`
- `results/figures/gsea/GSEA_Waterfall_KEGG_Legacy.png`
- `results/figures/gsea/GSEA_Waterfall_KEGG_Medicus.png`

### Tables

Differential expression tables:
- `results/tables/deg/DEG_Results_LumA_IDC_Tumor_vs_AllNormals_limma.csv`
- `results/tables/deg/DEG_Results_LumA_IDC_Tumor_vs_AllNormals_limma_annotated.csv`

GSEA tables:
- `results/tables/gsea/GSEA_ALL_summary_LumA_IDC_Tumor_vs_AllNormals.csv`
- `results/tables/gsea/LumA_IDC_Tumor_vs_AllNormals.rnk`

---

## Reproducibility Notes

- The pipeline is deterministic up to the GSEA step.
- GSEA results depend on:
  - External software version
  - Gene set library versions
  - Ranking metric (t-statistics)
- All scripts assume execution from the repository root.

---

## Summary

- Raw TCGA data: manually downloaded
- Preprocessing and differential expression: fully automated
- GSEA: manual external step
- Visualization and summaries: automated once GSEA outputs are placed correctly

This separation is intentional and documented to ensure transparency and reproducibility.
